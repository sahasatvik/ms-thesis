\section{Functional depth functions}

For $\mathscr{X} = L_2$, the spatial depth has its natural functional
analogue.

\begin{definition}[Functional spatial depth]
    The spatial depth for $\mathscr{X} = L_2$ is defined as
    \begin{equation}
        D_S(\vx, F_{\vX}) = 1 - \left\Vert \E_{\vX \sim F} \left[\frac{\vx - \vX\;\,}{\norm{\vx - \vX}_2}\right] \right\Vert_2,
    \end{equation}
    where $\norm{\Cdot}_2$ denotes the standard $L_2$ norm.
\end{definition}


\subsection{Summary depths}

Let $D$ be a multivariate depth function.
We can use this to define the depth of a curve $\vx$ by first computing the
multivariate $D$-depth of each time slice $\vx(t)$, then `summarizing' these
depths over all $t \in [0, 1]$.
One possibility is to take a simple or weighted time average as follows.

\begin{definition}[Fraiman-Muniz depth]
    The integrated depth, or Fraiman-Muniz depth, is defined as
    \begin{equation}
        D_F(\vx, F_{\vX}) = \int_{[0, 1]} D(\vx(t), F_{\vX(t)})\:w(t)\:dt.
    \end{equation}
    Here, $w$ is a weight function.
\end{definition}

Alternatively, we may choose the lowest or `worst' depth over time.
This way, low depth values over small portions of time, which indicate a
deviation from centrality, are better reflected in the summary.

\begin{definition}[Infimal depth]
    The infimal depth is defined as
    \begin{equation}
        D_{Inf}(\vx, F_{\vX}) = \inf_{t \in [0, 1]} D(\vx(t), F_{\vX(t)}).
    \end{equation}
\end{definition}



\subsection{Band depths}

\textcite{pintado-romo-2009} later introduced the notion of band depth for
univariate functional data.

\begin{definition}[Band depth]
    The band depth, for some index $J \geq 2$, is defined as
    \begin{equation}
        D_B^J(\vx, F_{\vX}) = \sum_{j = 2}^J\, P_{\vX_i \iid F_{\vX}}(\vx \in \conv(\vX_1, \dots, \vX_j)).
    \end{equation}
\end{definition}
The empirical version of band depth is defined as
\begin{equation}
    D_B^J(\vx, \hat{F}_n) = \sum_{j = 2}^J\binom{n}{j}^{-1} \sum_{\substack{1 \leq i_1 < \dots < i_j \leq n}} \bm{1}(\vx \in \conv(\vx_{i_1}, \dots, \vx_{i_j})).
\end{equation}
This is simply the proportion of $j$-tuples of curves (for $2 \leq j \leq J$)
which envelope $\vx$.
Note that if two curves intersect at a point, a third curve is enveloped by
them only when it passes through the point of intersection, i.e.\ with
probability zero.
Thus, we generally use $J = 3$.


\begin{definition}[Modified band depth]
    Define the enveloping time
    \begin{equation}
        \ET(\vx;\, \vx_1, \dots, \vx_j) = m_1(\{t \in [0, 1]\colon \vx \in \conv(\vx_1, \dots, \vx_j)\}),
    \end{equation}
    where $m_1$ is the Lebesgue measure on $\R$.
    The modified band depth is defined as
    \begin{equation}
        D_{MB}^J(\vx, F_{\vX}) = \sum_{j = 2}^J\, \E_{\vX_i \iid F_{\vX}}\left[ \ET(\vx;\, \vX_1, \dots, \vX_j)\right].
    \end{equation}
\end{definition}
The empirical version of modified band depth is defined as
\begin{equation}
    D_{MB}^J(\vx, \hat{F}_n) = \sum_{j = 2}^J\binom{n}{j}^{-1} \sum_{\substack{1 \leq i_1 < \dots < i_j \leq n}} \ET(\vx;\, \vx_{i_1}, \dots, \vx_{i_j}).
\end{equation}
We generally use $J = 2$ for ease of computation, and denote the corresponding
modified band depth simply as $D_{MB}(\Cdot, \Cdot)$, dropping the
superscript.
\begin{equation}
    D_{MB}(\vx, \hat{F}_n) = \binom{n}{2}^{-1}\sum_{i = 1}^n\sum_{j = i + 1}^n \ET(\vx; \vx_i, \vx_j).
\end{equation}



\subsection{Half-region depths}

Later, \textcite{pintado-romo-2011} introduced the half-region depth.

\begin{definition}
    We say that $\vy$ is in the hypograph of $\vx$, denoted, $\vy \in
    H_{\vx}$, if $\vy(t) \leq \vx(t)$ for all $t \in [0, 1]$.
    Similarly, we say that $\vy$ is in the epigraph of $\vx$, denoted, $\vy
    \in E_{\vx}$, if $\vy(t) \geq \vx(t)$ for all $t \in [0, 1]$.
\end{definition}

\begin{definition}[Half-region depth]
    The half-region depth is defined as
    \begin{equation}
        D_{HR}(\vx, F) = \min\{P_F(H_{\vx}),\, P_F(E_{\vx})\}.
    \end{equation}
\end{definition}

The quantity $P_F(E_{\vx})$ is called the epigraph index, which measures the
proportion of curves that lie entirely above $\vx$.

\begin{definition}[Modified half-region depth]
    Denote the superior modified hypograph (MHI) and epigraph (MEI) indices
    \begin{align}
        \MHI_F(\vx) &= \E_{\vX \sim F}[m_1(\{t \in [0, 1]\colon \vx(t) \geq \vX(t)\})], \\
        \MEI_F(\vx) &= \E_{\vX \sim F}[m_1(\{t \in [0, 1]\colon \vx(t) \leq \vX(t)\})].
    \end{align}
    The modified half-region depth is defined as
    \begin{equation}
        D_{MHR}(\vx, F) = \min\{\MHI_F(\vx),\, \MEI_F(\vx)\}.
    \end{equation}
\end{definition}
